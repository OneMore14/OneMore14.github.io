---
layout: post
title:  "Redos"
date:   2024-01-13 10:43:01 +0800
tags: 后端
typora-root-url: ../../../
---



### 事务/Atomic

Redis事务由 ```MULTI``` 开启，然后不断输入命令，这些命令不会被执行，直到输入 ```EXEC``` 。Redis保证在执行事务时，不会处理其他客户端的请求，但是在执行事务中遇到错误时，不会回滚，也不会停止执行。

另外Redis没有条件更新的语句，因此只能先读数据做判断要更新后再执行事务，然而可能判断完后其他客户端又修改了值，因此引入 ```watch``` 指令，如果watch的变量在exec之前被修改了，就不会执行事务。

当然也可以使用Lua脚本，官方说simpler and faster。执行Lua脚本时不会执行其他命令